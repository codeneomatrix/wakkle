function generateUUID(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function loadScript(e,t){var n=document.getElementsByTagName("head")[0],o=document.createElement("script");o.type="text/javascript",o.src=e,o.onreadystatechange=t,o.onload=t;for(var i=document.getElementsByTagName("script"),r=!1,a=0;a<i.length;a++)src=i[a].getAttribute("src"),null!=src&&src.search(e)>-1&&(r=!0);r||n.appendChild(o)}function setController(e){for(var t=document.getElementsByClassName("control-link"),n=0;n<t.length;n++)t[n].classList.remove("active");document.getElementById(e).classList.add("active"),controller.setActive(e)}function windowWidth(){return"innerWidth"in window?window.innerWidth:document.documentElement.offsetWidth}function windowHeight(){return"innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight}function removeFromArray(e){for(var t,n=arguments,o=n.length,i;o>1&&e.length;)for(t=n[--o];-1!==(i=e.indexOf(t));)e.splice(i,1);return e}function sortArrayMiddleToOut(e){for(var t=Math.ceil(e.length/2),n=[],o=t,i=o+1;i<e.length||o>=0;)o>=0&&n.push(e[o]),i<e.length&&n.push(e[i]),o--,i++;return n}function getPlaceholders(){for(var e=new RegExp(".*?.wakkl.jpg$","i"),t=document.getElementsByTagName("img"),n=[],o,i,r=0;r<t.length;r++)element=t[r],element.hasAttribute("src")&&(o=element.getAttribute("src"),e.test(o)&&(element.id=element.id||generateUUID(),n.push(element)));return n}!function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var o=(new Date).getTime(),i=Math.max(0,16-(o-e)),r=window.setTimeout(function(){t(o+i)},i);return e=o+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),window.getComputedStyle||(window.getComputedStyle=function(e,t){return this.el=e,this.getPropertyValue=function(t){var n=/(\-([a-z]){1})/g;return"float"==t&&(t="styleFloat"),n.test(t)&&(t=t.replace(n,function(){return arguments[2].toUpperCase()})),e.currentStyle[t]?e.currentStyle[t]:null},this}),function(e,t){function n(e){var n=t[e];t[e]=function(e){return i(n(e))}}function o(t,n,o){return(o=this).attachEvent("on"+t,function(t){var t=t||e.event;t.preventDefault=t.preventDefault||function(){t.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){t.cancelBubble=!0},n.call(o,t)})}function i(e,t){if(t=e.length)for(;t--;)e[t].addEventListener=o;else e.addEventListener=o;return e}e.addEventListener||(i([t,e]),"Element"in e?e.Element.prototype.addEventListener=o:(t.attachEvent("onreadystatechange",function(){i(t.all)}),n("getElementsByTagName"),n("getElementById"),n("createElement"),i(t.all)))}(window,document),"classList"in document.documentElement||!Object.defineProperty||"undefined"==typeof HTMLElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){function e(e){return function(n){var o=t.className.split(/\s+/),i=o.indexOf(n);e(o,i,n),t.className=o.join(" ")}}var t=this,n={add:e(function(e,t,n){~t||e.push(n)}),remove:e(function(e,t){~t&&e.splice(t,1)}),toggle:e(function(e,t,n){~t?e.splice(t,1):e.push(n)}),contains:function(e){return!!~t.className.split(/\s+/).indexOf(e)},item:function(e){return t.className.split(/\s+/)[e]||null}};return Object.defineProperty(n,"length",{get:function(){return t.className.split(/\s+/).length}}),n}});var WIDTH=windowWidth(),HEIGHT=windowHeight(),getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia,Controller=function(){function e(){function e(e){void 0!=q?q.q=e:console.log("No object there to be updated.")}function t(t){var n=t.pageX;z=n/WIDTH,e(z)}function a(e){F=1,S=e.pageX||e.changedTouches[0].pageX,P=e.pageY||e.changedTouches[0].pageY,document.body.style.cursor="grabbing"}function s(e){F=0,O=0,document.body.style.cursor="grab"}function c(t){if(t.preventDefault(),F){var n=t.pageX||t.changedTouches[0].pageX,o=t.pageY||t.changedTouches[0].pageY,i=n-(O||S);O=n,(I>0&&i<0||I<0&&i>0)&&(S=O),I=i;var r=I/WIDTH;r=-r,T=1-z,T+=r,T=T>1?1:T,T=T<0?0:T,z=1-T,e(z)}}function l(t){if(!F){var n,o;switch(window.orientation){case 0:case 180:n="portrait";break;case 90:case-90:n="landscape";break}o="portrait"==n?t.gamma:t.beta,o=o>45?45:o,z=(o+45)*(1/90),z=z<0?0:z,z=z>1?1:z,e(z)}}function d(e){"found"==e.status&&console.log("found")}function u(t){console.log("headtrack event"),camFov=Math.floor(n.getFOV())/2,z=t.x/camFov+.5-1,z*=.1,z=z>=1?1:z,z=z<=0?0:z,e(z)}function m(t){console.log("facetrack event"),camFov=Math.floor(n.getFOV())/2,z=t.x/camFov+.5-1,z*=.1,z=z>=1?1:z,z=z<=0?0:z,e(z)}function p(e){switch(A(),g(),b(),k(),f(),M=e,e){case"mousemove":h();break;case"mousedrag":w();break;case"headtrack":L();break;case"deviceorientation":v();break;case"touchdrag":y();break;case"orientationdrag":x();break}}function h(){document.addEventListener("mousemove",t,!1)}function g(){document.removeEventListener("mousemove",t,!1)}function v(){window.addEventListener("deviceorientation",l,!1)}function f(){window.removeEventListener("deviceorientation",l,!1)}function w(){document.body.style.cursor="grab",document.addEventListener("mousedown",a),document.addEventListener("mouseup",s),document.addEventListener("mousemove",c)}function b(e){document.body.style.cursor="initial",document.removeEventListener("mousedown",a),document.removeEventListener("mouseup",s),document.removeEventListener("mousemove",c)}function y(){document.addEventListener("touchstart",a),document.addEventListener("touchmove",c),document.addEventListener("touchend",s)}function k(){document.removeEventListener("touchstart",a),document.removeEventListener("touchend",s),document.removeEventListener("touchmove",c)}function x(){window.addEventListener("deviceorientation",l,!1),document.addEventListener("touchstart",a),document.addEventListener("touchmove",c),document.addEventListener("touchend",s)}function E(){window.removeEventListener("deviceorientation",l,!1),document.removeEventListener("touchstart",a),document.removeEventListener("touchend",s),document.removeEventListener("touchmove",c)}function C(){o=document.createElement("video"),o.id="inputVideo",o.autoplay=!0,o.style.display="none",document.body.appendChild(o),i=document.createElement("canvas"),i.id="inputCanvas",i.style.visibility="hidden",i.style.position="absolute",document.body.appendChild(i),r=document.createElement("canvas"),r.id="debugCanvas",r.width=320,r.height=240,r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.zIndex="9999",r.style.display=this.debug?"block":"none",document.body.appendChild(r),n=new headtrackr.Tracker({ui:!0,cameraOffset:10,debug:r,smoothing:!1})}function L(){getUserMedia&&n&&(n.init(o,i),n.start(),getUserMedia=getUserMedia.bind(navigator),document.addEventListener("facetrackingEvent",m),document.addEventListener("headtrackrrStatus",d))}function A(){getUserMedia&&n&&(document.removeEventListener("facetrackingEvent",m),n.stop(),n.stopStream())}function j(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}var q,M,z=.5,T=.5,N,S,P,F,O,I=0;return p(j()?"orientationdrag":"mousemove"),getUserMedia&&loadScript("js/vendor/headtrackr.min.js",C),{setActive:function(e){p(e)},getActive:function(){return M},listAvailable:function(){var e=[];return j()||(e=["mousemove","mousedrag"],getUserMedia&&e.push("headtrack")),j()&&(e=["orientationdrag"]),e},update:function(e){q=e},UI:function(e){var t="controls",n="controls",o=document.getElementById(t);document.contains(o)&&o.remove();var e=void 0===e||e;if(e){var i=this.listAvailable(),r=document.createElement("ul");r.className="controls",r.id=t;for(var a=0;a<i.length&&!(i.length<2);a++){var s=document.createElement("li"),c=document.createElement("a");c.className="control-link icon-"+i[a],c.id=i[a],c.href="javascript: setController('"+i[a]+"')";var l=document.createTextNode(i[a]);c.appendChild(l),s.appendChild(c),r.appendChild(s)}document.body.appendChild(r),i.length>1&&setController(i[0])}}}}var t,n,o,i,r;return{getInstance:function(){return t||(t=e()),t}}}(),onresize=function(e){WIDTH=windowWidth(),HEIGHT=windowHeight()};window.addEventListener("resize",onresize),function(){"use strict";function e(e,t){var n=[],o=this.options;return o.onProgress&&e&&o.onProgress.call(this,e,t,this.completed.length),this.completed.length+this.errors.length===this.queue.length&&(n.push(this.completed),this.errors.length&&n.push(this.errors),o.onComplete.apply(this,n)),this}var t=function(e,t){this.options={pipeline:!1,auto:!0,onComplete:function(){}},t&&"object"==typeof t&&this.setOptions(t),this.addQueue(e),this.queue.length&&this.options.auto&&this.processQueue()};t.prototype.setOptions=function(e){var t=this.options,n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return this},t.prototype.addQueue=function(e){return this.queue=e.slice(),this},t.prototype.reset=function(){return this.completed=[],this.errors=[],this},t.prototype.load=function(t,n){var o=new Image,i=this,r=this.options;return o.onerror=o.onabort=function(){this.onerror=this.onabort=this.onload=null,i.errors.push(t),r.onError&&r.onError.call(i,t),e.call(i,t),r.pipeline&&i.loadNext(n)},o.onload=function(){this.onerror=this.onabort=this.onload=null,i.completed.push(t),e.call(i,t,this),r.pipeline&&i.loadNext(n)},o.src=t,this},t.prototype.loadNext=function(e){return e++,this.queue[e]&&this.load(this.queue[e],e),this},t.prototype.processQueue=function(){var e=0,t=this.queue,n=t.length;if(this.reset(),this.options.pipeline)this.load(t[0],0);else for(;e<n;++e)this.load(t[e],e);return this},"function"==typeof define&&define.amd?define(function(){return t}):this.preLoader=t}.call(this);for(var Wakkl=function(e){function t(){var t,n;return t=e.currentSrc||e.src,t=t.replace(".wakkl.jpg",""),t+="/",h(t+"meta.json",function(e){n={Path:t,Count:e.wakkl.Count,AngleOfView:e.wakkl.AngleOfView,Phi:e.wakkl.Phi,Chi:e.wakkl.Chi}}),n}function n(){for(var e,t=[],n=0;n<v.Count;n++)e=v.Path+p(n,v.Count.toString().length)+".jpg",t[n]=e;return t}function o(){var t=document.createElement("figure"),n=window.getComputedStyle(e,null).getPropertyValue("object-fit");e.hasAttributes()&&c(e,t),t.removeAttribute("src"),t.removeAttribute("srcset"),"static"==window.getComputedStyle(e,null).getPropertyValue("position")&&(t.style="relative"),e.style.position="absolute",e.parentNode.insertBefore(t,e),t.appendChild(e);var o=sortArrayMiddleToOut(f),i=Math.ceil(f.length/2),l=i-1,d=v.Path+p(i,v.Count.toString().length)+".jpg",u=v.Path+p(l,v.Count.toString().length)+".jpg",m=[],h=document.createElement("progress");h.setAttribute("max",o.length),h.setAttribute("value",0),document.body.appendChild(h),new preLoader(o,{onProgress:function(e,n,o){var c=Math.floor(100/this.queue.length*this.completed.length);h.value=o,C>3&&void 0===b&&s(),m.push(e);for(var g=0;g<m.length;g++)m.indexOf(d)>=0&&(removeFromArray(m,d),r(d,t),i++,d=v.Path+p(i,v.Count.toString().length)+".jpg"),m.indexOf(u)>=0&&(removeFromArray(m,u),a(u,t),l--,u=v.Path+p(l,v.Count.toString().length)+".jpg")},onComplete:function(e,t){h.style.display="none"}})}function i(t){var n=window.getComputedStyle(e,null).getPropertyValue("object-fit"),o=document.createElement("img");return o.src=t,o.style.filter="alpha(opacity = 0)",o.style.opacity=0,o.style.position="absolute","fill"!=n&&"none"!=n&&(o.style.objectFit=n,o.style.width=(e.hasAttribute("width")?e.width:e.style.width)||"100%",o.style.height=(e.hasAttribute("height")?e.height:e.style.height)||"auto"),o}function r(e,t){var n=i(e);t.appendChild(n),C++}function a(e,t){var n=i(e);t.insertBefore(n,t.firstChild),C++}function s(){void 0==E&&(E=Math.round((C-1)*g.q)),void 0==x&&(x=g.q),x+=(g.q-x)*w,x=d(x,4);var t=document.getElementById(e.id).childNodes,n=Math.round((C-1)*x);t[E].style.filter="alpha(opacity = 0)",t[E].style.opacity=0,t[n].style.filter="alpha(opacity = 1)",t[n].style.opacity=1,E=n,y=x,b=window.requestAnimationFrame(s)}function c(e,t){for(var n=0;n<e.attributes.length;n++){var o=e.attributes[n];t.setAttribute(o.name,o.value)}}function l(e,t){return Math.abs(e-t)}function d(e,t){return void 0===t||0==+t?Math.round(e):(e=+e,t=+t,isNaN(e)||"number"!=typeof t||t%1!=0?NaN:(e=e.toString().split("e"),e=Math.round(+(e[0]+"e"+(e[1]?+e[1]+t:t))),e=e.toString().split("e"),+(e[0]+"e"+(e[1]?+e[1]-t:-t))))}function u(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}function m(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}function p(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function h(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var e=JSON.parse(n.responseText);console.log(e),console.log(e.wakkl.Count),t&&t(e)}},n.open("GET",e,!1),n.send()}var g=this,v,f,w=.1,b,y,k=.5,x,E,C=0;this.q=k,this.init=function(){var i=e.currentSrc||e.src,r=new Image;r.onload=function(){v=t(),f=n(),o()},r.src=i}},Soundl=function(){},placeholders=getPlaceholders(),wakkl=[],i=0;i<placeholders.length;i++){var placeholder=placeholders[i];wakkl[i]=new Wakkl(placeholder),wakkl[i].init()}var controller=Controller.getInstance();controller.UI(),controller.update(wakkl[0]);